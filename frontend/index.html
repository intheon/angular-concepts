<!doctype html>

<html ng-app="ngSkateApp">

<head>
	<meta charset="utf-8">
	<title>SkateLocate</title>
	<meta name="description" content="An app to find and locate skateparks and skate spots">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- CSS -->
	<link rel="stylesheet" href="css/material.css" />
	<link rel="stylesheet" href="css/swiper.css" />
	<link rel="stylesheet" href="css/style.css" />

	<!-- Icons -->
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

</head>

<body ng-controller="ListCtrl">

	<div class="app-wrapper" ng-controller="MapCtrl">

		<div ng-controller="VoteCtrl">

			<!-- Preloader -->
			<div class="preload">
				<div class="preloader-wrapper big active">
					<div class="spinner-layer spinner-blue-only">
						<div class="circle-clipper left">
							<div class="circle"></div>
						</div>
						<div class="gap-patch">
							<div class="circle"></div>
						</div>
						<div class="circle-clipper right">
							<div class="circle"></div>
						</div>
					</div>
				</div>
			</div>

			<!-- the main list/map of items -->
			<div class="left-column">

				<!-- A directive to handle the map -->
				<ng-map class="map" zoom="5" center="48.60385760823255, 18.9404296875" styles="{{ styles }}" on-click="" trigger-resize>

					<!-- InfoWindow for EXISTING markers -->
					<info-window id="detailsWindow" class="detailsWindow" max-width="1400">

						<div class="card-wrapper" ng-non-bindable="">

							<header class="layered-info">

								<!-- only show if theres images in the slideshow -->
								<div ng-if="currentSkatepark.skateparkImages.length > 0">

									<figure class="slideshow slideshowOfImages">

										<div class="swiper-container">

											<div class="swiper-wrapper" >
							
												<div class="swiper-slide keep-aspect" ng-repeat="imageSrc in currentSkatepark.skateparkImages" >

													<img ng-src="{{ imageSrc }}"  class="swiper-lazy fixed-height">

													<div class="swiper-lazy-preloader"></div>

												</div>

											</div>
											

											<div class="swiper-pagination swiper-pagination-white" ng-if="currentSkatepark.skateparkImages.length > 1"></div>
											<div class="swiper-button-next swiper-button-white swiper-nav" ng-if="currentSkatepark.skateparkImages.length > 1"></div>
											<div class="swiper-button-prev swiper-button-white swiper-nav" ng-if="currentSkatepark.skateparkImages.length > 1"></div>
										</div>

									</figure>

								</div>

								<!-- only show if theres NO images -->
								<div ng-if="currentSkatepark.skateparkImages.length === 0">
									<img src="/img/defaultSkatepark.jpg" width="100%" alt="">
								</div>


							</header>

							<main>
								<section class="main-info-fixed">
									<h4>{{ currentSkatepark.skateparkName }}</h4>



									<time><i class="material-icons prefix tiny">face</i> {{ currentSkatepark.skateparkAdder }} added on {{ currentSkatepark.createdAt | date: 'MMM d' }} </time>

									<div class="tool-image" ng-click="showTools('')"><i class="material-icons prefix tiny">add</i> Add Screenshot</div>
									<div class="tool-image" ng-click="showSlideshowModal('')"><i class="material-icons prefix tiny">launch</i> View Images fullscreen</div>

								</section>

								<section class="description">

									{{ currentSkatepark.skateparkDesc }}

								</section>

								<section class="hidden-tools">

										<form action="#" class="add-skate-images" ng-controller="updateSkateparkImagesCtrl">
										<!-- Ask for a remote url -->
										<div class="input-field">
											<input type="text" ng-model="addAmendment.screenshotURL">
											<label for="screenshotURL">Paste a link to an image...</label>
										</div>

										<!-- Ask for screenshots -->
										<div class="file-field input-field small tucked">

											<div class="waves-effect light-blue lighten-4 btn-flat ">
												<div>File</div>
												<input type="file" ngf-select ng-model="addAmendment.screenshots" ngf-multiple="true" accept="image/*" ngf-max-size="4MB">
											</div>

											<!--
											<div class="file-path-wrapper">
												<input class="file-path validate" type="text"  placeholder="Or upload some!">
											</div>
											-->

											<input type="button" value="Submit!" class="waves-effect light-blue lighten-4 btn-flat" ng-click="updateSkateparkImages()">


										</div>
										<!-- Is hidden initially, but the Upload Service will command the width -->
										<div class="uploadScrollbar amendScrollbar">
										    <div class="determinate" style="width: 0%"></div>
										</div>
	        
									</form>

								</section>
							</main>

							<footer>
								<section class="votes" ng-controller="RatingCtrl">

									<div class="waves-effect light-blue lighten-4 btn-flat small" ng-click="incrementRating(currentSkatepark)" ng-hide="currentSkatepark.hasVote"><i class="material-icons left">backup</i>{{ currentSkatepark.skateparkRating }} votes</div>
									<div class="waves-effect btn-flat disabled small" ng-show="currentSkatepark.hasVote">{{ currentSkatepark.skateparkRating }} votes</div>


								</section>
								<section class="comments">

									<div class="waves-effect btn-flat small" ng-click="" ng-hide=""><i class="material-icons left">comment</i>0 comments</div>

								</section>
							</footer>






						</div>


					</info-window>


					<!-- InfoWindow for NEW markers -->
					<info-window id="newSkateparkWindow" ng-controller="addNewSkateparkCtrl">

						<form action="#" class="add-skate-location ">

							<!-- Ask for the skatepark name -->
							<div class="input-field row" >
								<i class="material-icons prefix">room</i>
								<input type="text" ng-model="addNew.skateparkName" id="skateparkName">
								<label for="skateparkName">Skatepark Name</label>
							</div>

							<!-- Ask for your name -->
							<div class="input-field row">
								<i class="material-icons prefix">person_pin</i>
								<input type="text" ng-model="addNew.skateparkAdder" id="skateparkAdder">
								<label for="skateparkAdder">Your Name</label>
							</div>

							<!-- Ask for the name -->
							<div class="input-field row">
								<i class="material-icons prefix">mode_edit</i>
								<textarea class="materialize-textarea" ng-model="addNew.skateparkDesc" id="skateparkDesc"></textarea>
								<label for="skateparkDesc">A description - Optional.</label>
							</div>

							<!-- Ask for a remote url -->
							<div class="input-field row">
								<i class="material-icons prefix">link</i>
								<input type="text" ng-model="addNew.screenshotURL" id="screenshotURL">
								<label for="screenshotURL">Paste a link to an image...</label>
							</div>

							<!-- Ask for screenshots -->
							<div class="file-field input-field row">
								<div class="btn waves-effect waves-light">
									<div>File</div>
									<input type="file" ngf-select ng-model="addNew.screenshots" ngf-multiple="true" accept="image/*" ngf-max-size="4MB">
								</div>
								<div class="file-path-wrapper">
									<input class="file-path validate" type="text"  placeholder="Or upload some!">
								</div>
							</div>


							<!-- Submit button -->
							<div class="row">
								<input type="button" value="Submit!" class="btn col s12" ng-click="submitNewSkateparkForm()">
							</div>

							<!-- Is hidden initially, but the Upload Service will command the width -->
							  <div class="progress">
							      <div class="determinate loadingBar" style="width: 0%"></div>
							  </div>
        
						</form>

					</info-window>

					<!-- This will be dynamically draw ALL EXISTING markers in the allData array -->
					<marker ng-repeat="marker in allData | filter: parks" position="{{marker.skateparkLocation}}" title="{{marker.skateparkName}}" id="{{marker._id}}" on-click="showSkateparkDetails(marker)">
					</marker>

					<!-- This is the POTENTIAL marker that will appear when the user clicked on the map. it can theoretically go anywhere -->
					<marker ng-repeat="marker in clickedLocation" position="{{ marker.location }}" title="This is a marker" id="inProgressMarker">
					</marker>

					<!-- this is IMMEDIATELY added because otherwise I cant style the infoWindows (dont ask) -->
					<marker ng-repeat="marker in fake" position="{{marker.skateparkLocation}}" id="showMePlease" </marker>

				</ng-map>

			</div>
			<!-- end left hand side -->

			<!-- right hand side -->
			<ul class="collapsible right-column" data-collapsible="expandable">

				<!-- First row -->
				<div class="full-width">

					<div class="row grey-header full-width">
						<h2><img src="./img/skate-icon.png" class="skate-icon faded" alt="skateboard icon" width="30px">SkateLocate</h2>
					</div>
					
					<div class="search-for-items nudged-menu full-width" ng-controller="SearchCtrl">
						<div class="input-field pad">
							<i class="material-icons prefix align">search</i>
							<input type="text" ng-model="searchString" id="search-parks"></input>
							<label for="search-parks">Search</label>
						</div>
					</div>


				</div>


				<!-- Third Row: Highest ranked items -->
				<li class="nudged-menu full-width">


					<h5 class="collapsible-header active"><i class="material-icons align faded">present_to_all</i>  Highest Voted <i class="material-icons grn-colour">swap_vert</i></h5>

					<div class="collapsible-body">

						<div ng-repeat="item in allData | orderBy: '-skateparkRating' | limitTo: 4" class="list-of-highest-rated-items collection mouse-clickable " ng-controller="RatingCtrl">

							<div class="collection-item avatar" ng-click="showSkateparkDetails(item._id, item)">
								<span class="absolute-label">{{ item.skateparkRating }}</span><i class=" circle"></i>
								<span class="title">{{ item.skateparkName }}</span>
								<upvote-button ng-click="incrementRating(item)" ng-hide="item.hasVote" class="secondary-content"></upvote-button>
							</div>

						</div>

					</div>
				</li>

				<!-- most recently added items -->
				<li class="nudged-menu full-width">
					<h5 class="collapsible-header"><i class="material-icons align faded">forward_10</i> Recently Added <i class="material-icons grn-colour">swap_vert</i></h5>
					<div class="list-of-most-recent-items collapsible-body">
						<div ng-repeat="item in rev(allData) | limitTo: 10">

							<div class="item-name" ng-click="showSkateparkDetails(item._id, item)">{{ item.skateparkName }} <span class="small"> {{ item.createdAt | date: 'h:mm a, MMM d' }} by {{ item.skateparkAdder }} </span>
							</div>

						</div>
					</div>
				</li>

				<!-- filters -->
				<li class="nudged-menu full-width">
					<h5 class="collapsible-header"><i class="material-icons align faded">filter_list</i> Filter <i class="material-icons grn-colour">swap_vert</i></h5>
					<div class="list-of-most-recent-items collapsible-body">
						<div ng-repeat="item in rev(allData) | limitTo: 10">

							<div class="item-name" ng-click="showSkateparkDetails(item._id, item)">{{ item.skateparkName }} <span class="small"> {{ item.createdAt | date: 'h:mm a, MMM d' }} by {{ item.skateparkAdder }} </span>
							</div>

						</div>
					</div>
				</li>


				<!-- bottom stuff -->
				<div class="info-triangle"></div>

				<div class="bottom-right">




					<div class="modal-settings-help">
						<div class="users-connected">
							<div class="number-connected-users"></div>
						</div>
						<i class="material-icons green-icon">help</i>
						<i class="material-icons green-icon">settings</i>
						<i class="material-icons green-icon">people</i>
					</div>

					<!-- a toggle switch -->
					<div class="switch" id="responsive-panel" ng-controller="responsiveCtrl">
						<label>
							Show
							<input type="checkbox">
							<span class="lever" ng-click="togglePanel()" id="resizeSwitch"></span>
							Hide
						</label>
					</div>

				</div>

			</ul>
			<!-- end right hand side -->

		</div>

	</div>



	<!-- JAVASCRIPT -->

	<!-- 3rd party libraries -->
	<script src="../libraries/jquery.js"></script>
	<script src="../libraries/angular.js"></script>
	<script src="../libraries/underscore.js"></script>
	<script src="../libraries/angular-route.js"></script>
	<script src="../libraries/swiper.dev.js"></script>
	<script src="../libraries/angular-local-storage.js"></script>
	<script src="../libraries/ng-map-dev.js"></script>
	<script src="../libraries/socket.io.js"></script>
	<script src="../libraries/material.js"></script>
	<script src="../libraries/cloudinary-core.js"></script>
	<script src="../libraries/angular-animate.js"></script>
	<script src="../libraries/angular-route.js"></script>
	<script src="../libraries/angular-resource.js"></script>
	<script src="../libraries/angular.cloudinary.js"></script>
	<script src="../libraries/jquery.ui.widget.js"></script>
	<script src="../libraries/jquery.iframe-transport.js"></script>
	<script src="../libraries/jquery.fileupload.js"></script>
	<script src="../libraries/ng-file-upload.js"></script>


	<!-- API -->
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyALYjGkfn-RVIETHo-KCBz_1zbVW1OH-O0"></script>

	<!-- Custom JS  -->

	<script src="js/sockets.js"></script>
	<script src="js/controllers.js"></script>
	<script src="js/directives.js"></script>
	<script src="js/factories.js"></script>
	<script src="js/filters.js"></script>


</body>

</html>